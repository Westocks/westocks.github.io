<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>WESTOCKS Demo</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
html,body{
  margin:0;height:100%;overflow:hidden;
  font-family:Arial,sans-serif;color:white
}
body{
  background:linear-gradient(270deg,#0f2027,#203a43,#2c5364);
  background-size:600% 600%;
  animation:bgMove 18s ease infinite;
}
@keyframes bgMove{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

canvas#stars{
  position:fixed;inset:0;z-index:0
}

.app{
  position:relative;z-index:1;
  height:100%;
  display:flex;
  justify-content:center;
  align-items:center
}

.panel{
  background:rgba(0,0,0,.45);
  border-radius:16px;
  padding:26px;
  width:950px;
  max-height:92%;
  overflow:auto;
  box-shadow:0 0 40px rgba(0,0,0,.6)
}

h1{text-align:center;letter-spacing:4px;margin-top:0}
.small{opacity:.8;font-size:13px}

button{
  padding:8px 14px;
  border:none;border-radius:8px;
  font-weight:bold;cursor:pointer
}
.start-btn{background:white;color:#061124;font-size:16px}
.stock{
  background:rgba(255,255,255,.08);
  border-radius:12px;
  padding:14px;margin-top:14px
}
.stock-header{
  display:flex;justify-content:space-between;align-items:center
}
.stock-price{font-weight:800}
.toggle{background:rgba(255,255,255,.18);color:white}
.trade{background:white;color:black}

canvas.graph{
  width:100%;
  height:120px;
  margin-top:10px;
  background:rgba(0,0,0,.25);
  border-radius:8px
}
</style>
</head>

<body>
<canvas id="stars"></canvas>

<div class="app">
  <div class="panel">

    <h1>WESTOCKS</h1>

    <!-- START -->
    <div id="start">
      <p class="small" style="text-align:center">
        Demo only â€” NOT real money
      </p>
      <div style="text-align:center;margin-top:30px">
        <button class="start-btn" onclick="startDemo()">
          Start investing (Demo)
        </button>
      </div>
    </div>

    <!-- MARKET -->
    <div id="market" style="display:none">
      <div class="small">
        Cash: $<span id="cash">1000.00</span>
      </div>

      <div style="margin:12px 0">
        <button class="toggle" onclick="toggleAllGraphs()">
          Toggle All Graphs
        </button>
      </div>

      <div id="stocks"></div>
    </div>

  </div>
</div>

<script>
/* ===== STAR BACKGROUND ===== */
const sc=document.getElementById("stars");
const sctx=sc.getContext("2d");

function resize(){
  sc.width=innerWidth;
  sc.height=innerHeight;
}
resize();
addEventListener("resize",resize);

const stars=[...Array(180)].map(()=>({
  x:Math.random()*innerWidth,
  y:Math.random()*innerHeight,
  r:Math.random()*1.5+.3,
  v:Math.random()*.4+.1
}));

(function animateStars(){
  sctx.clearRect(0,0,sc.width,sc.height);
  for(const s of stars){
    s.y+=s.v;
    if(s.y>sc.height)s.y=0;
    sctx.globalAlpha=Math.random();
    sctx.beginPath();
    sctx.arc(s.x,s.y,s.r,0,Math.PI*2);
    sctx.fillStyle="white";
    sctx.fill();
  }
  requestAnimationFrame(animateStars);
})();

/* ===== DATA ===== */
let cash=1000;
let allGraphsVisible=false;

const stocks={
  NOVA:{name:"Nova Dynamics",price:120,shares:0,history:[120]},
  ORBX:{name:"Orbex Labs",price:75,shares:0,history:[75]},
  ZENT:{name:"Zenith Core",price:200,shares:0,history:[200]}
};

/* ===== START ===== */
function startDemo(){
  document.getElementById("start").style.display="none";
  document.getElementById("market").style.display="block";
  render();
}

/* ===== PRICE MOVEMENT ===== */
function updatePrices(){
  for(const sym in stocks){
    const st=stocks[sym];
    const change=(Math.random()-.5)*0.08;
    st.price=Math.max(5,+(st.price*(1+change)).toFixed(2));
    st.history.push(st.price);
    if(st.history.length>80)st.history.shift();
  }
  render();
}
setInterval(updatePrices,3000);

/* ===== BUY / SELL ===== */
function buy(sym){
  const usd=parseFloat(prompt("How much USD do you want to buy?"));
  if(isNaN(usd)||usd<=0)return;
  const st=stocks[sym];
  cash-=usd;
  st.shares+=usd/st.price;
  render();
}

function sell(sym){
  const st=stocks[sym];
  const qty=parseFloat(prompt("How many shares do you want to sell?"));
  if(isNaN(qty)||qty<=0)return;
  if(qty>st.shares)return alert("Not enough shares");
  st.shares-=qty;
  cash+=qty*st.price;
  render();
}

/* ===== GRAPHS ===== */
function toggleAllGraphs(){
  allGraphsVisible=!allGraphsVisible;
  render();
}

function drawGraph(sym){
  const c=document.getElementById("g-"+sym);
  const ctx=c.getContext("2d");
  const data=stocks[sym].history;
  ctx.clearRect(0,0,c.width,c.height);
  if(data.length<2)return;

  const min=Math.min(...data);
  const max=Math.max(...data);

  ctx.strokeStyle="white";
  ctx.beginPath();
  data.forEach((p,i)=>{
    const x=i/(data.length-1)*c.width;
    const y=c.height-(p-min)/(max-min+0.01)*c.height;
    i?ctx.lineTo(x,y):ctx.moveTo(x,y);
  });
  ctx.stroke();
}

/* ===== RENDER ===== */
function render(){
  document.getElementById("cash").innerText=cash.toFixed(2);
  const wrap=document.getElementById("stocks");
  wrap.innerHTML="";

  for(const sym in stocks){
    const st=stocks[sym];
    const div=document.createElement("div");
    div.className="stock";
    div.innerHTML=`
      <div class="stock-header">
        <div>
          <strong>${sym}</strong>
          <div class="small">${st.name}</div>
          <div class="small">Owned: ${st.shares.toFixed(3)}</div>
        </div>
        <div style="text-align:right">
          <div class="stock-price">$${st.price}</div>
          <button class="trade" onclick="buy('${sym}')">Buy</button>
          <button class="trade" onclick="sell('${sym}')">Sell</button>
        </div>
      </div>
      <canvas class="graph" id="g-${sym}" width="800" height="120"
        style="display:${allGraphsVisible?'block':'none'}"></canvas>
    `;
    wrap.appendChild(div);
    if(allGraphsVisible) drawGraph(sym);
  }
}
</script>

</body>
</html>
