<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>WESTOCKS</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
html,body{
  margin:0;
  height:100%;
  font-family:Arial,sans-serif;
  color:white;
}

/* BACKGROUND */
body{
  background:linear-gradient(270deg,#0f2027,#203a43,#2c5364);
  background-size:600% 600%;
  animation:bg 18s ease infinite;
  overflow-y:auto;
}
@keyframes bg{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

.container{
  max-width:1000px;
  width:95%;
  margin:40px auto;
  background:rgba(0,0,0,.45);
  padding:24px;
  border-radius:18px;
}

/* START SCREEN */
#start{
  text-align:center;
}
.logo{
  font-size:52px;
  letter-spacing:6px;
  font-weight:bold;
  color:#00faff;
  text-shadow:0 0 10px #00faff,0 0 30px #00faff;
  margin-bottom:20px;
}
.subtitle{opacity:.8;margin-bottom:30px}

button{
  padding:10px 18px;
  border:none;
  border-radius:8px;
  font-weight:bold;
  cursor:pointer;
}
.buy{background:white;color:black}
.sell{background:#ffb3b3;color:black}
.toggle{background:rgba(255,255,255,.2);color:white}

#market{display:none}

.stock{
  margin-top:20px;
  padding:16px;
  background:rgba(255,255,255,.08);
  border-radius:14px;
}

canvas{
  width:100%;
  height:140px;
  margin-top:10px;
  background:rgba(0,0,0,.35);
  border-radius:10px;
  display:none;
}

input{
  width:90px;
  padding:6px;
  border-radius:6px;
  border:none;
}

.pl{color:#00faff;font-weight:bold}
</style>
</head>

<body>
<div class="container">

<!-- START -->
<div id="start">
  <div class="logo">WESTOCKS</div>
  <div class="subtitle">Demo trading simulator</div>
  <button class="buy" id="startBtn">Start Investing</button>
</div>

<!-- MARKET -->
<div id="market">
  Cash: $<span id="cash">1000.00</span><br>
  Portfolio: $<span id="portfolio">1000.00</span>
  <div id="stocks"></div>
</div>

</div>

<script>
let cash=1000;

/* STORE INPUT VALUES */
let buyInputs={}, sellInputs={};

const stocks={
  NOVA:{price:120,shares:0,history:[120],buyPrice:null,show:false},
  ORBX:{price:80,shares:0,history:[80],buyPrice:null,show:false},
  ZENT:{price:200,shares:0,history:[200],buyPrice:null,show:false}
};

const startBtn=document.getElementById("startBtn");
const start=document.getElementById("start");
const market=document.getElementById("market");
const cashEl=document.getElementById("cash");
const portfolioEl=document.getElementById("portfolio");
const stocksEl=document.getElementById("stocks");

startBtn.onclick=()=>{
  start.style.display="none";
  market.style.display="block";
  render();
};

/* PRICE UPDATES */
setInterval(()=>{
  for(const s in stocks){
    let st=stocks[s];
    let ch=(Math.random()-0.5)*0.05;
    st.price=Math.max(1,+(st.price*(1+ch)).toFixed(2));
    st.history.push(st.price);
    if(st.history.length>60)st.history.shift();
  }
  render();
},2500);

/* ACTIONS */
function buy(s){
  let amt=+buyInputs[s];
  if(!amt||amt>cash)return;
  let st=stocks[s];
  cash-=amt;
  st.shares+=amt/st.price;
  st.buyPrice=st.price;
  buyInputs[s]="";
  render();
}
function buyAll(s){
  let st=stocks[s];
  st.shares+=cash/st.price;
  st.buyPrice=st.price;
  cash=0;
  render();
}
function sell(s){
  let qty=+sellInputs[s];
  let st=stocks[s];
  if(!qty||qty>st.shares)return;
  st.shares-=qty;
  cash+=qty*st.price;
  sellInputs[s]="";
  render();
}
function sellAll(s){
  let st=stocks[s];
  cash+=st.shares*st.price;
  st.shares=0;
  render();
}
function toggleGraph(s){
  stocks[s].show=!stocks[s].show;
  render();
}

/* GRAPH */
function drawGraph(s){
  let c=document.getElementById("g-"+s);
  let ctx=c.getContext("2d");
  let d=stocks[s].history;
  let min=Math.min(...d), max=Math.max(...d);

  ctx.clearRect(0,0,c.width,c.height);
  ctx.strokeStyle="#00faff";
  ctx.shadowBlur=15;
  ctx.shadowColor="#00faff";
  ctx.beginPath();
  d.forEach((p,i)=>{
    let x=i/(d.length-1)*c.width;
    let y=c.height-(p-min)/(max-min+0.01)*c.height;
    i?ctx.lineTo(x,y):ctx.moveTo(x,y);
  });
  ctx.stroke();

  if(stocks[s].buyPrice){
    let y=c.height-(stocks[s].buyPrice-min)/(max-min+0.01)*c.height;
    ctx.strokeStyle="lime";
    ctx.shadowColor="lime";
    ctx.beginPath();
    ctx.moveTo(0,y);
    ctx.lineTo(c.width,y);
    ctx.stroke();
  }
  ctx.shadowBlur=0;
}

/* RENDER */
function render(){
  cashEl.innerText=cash.toFixed(2);

  let total=cash;
  for(const s in stocks) total+=stocks[s].shares*stocks[s].price;
  portfolioEl.innerText=total.toFixed(2);

  stocksEl.innerHTML=Object.keys(stocks).map(s=>{
    let st=stocks[s];
    let pl=st.shares*(st.price-(st.buyPrice||st.price));
    return `
    <div class="stock">
      <strong>${s}</strong> â€” $${st.price}<br>
      Shares: ${st.shares.toFixed(3)}
      <span class="pl"> PL: $${pl.toFixed(2)}</span><br><br>

      Buy $ <input value="${buyInputs[s]||""}"
        oninput="buyInputs['${s}']=this.value">
      <button class="buy" onclick="buy('${s}')">Buy</button>
      <button class="buy" onclick="buyAll('${s}')">Buy All</button><br><br>

      Sell <input value="${sellInputs[s]||""}"
        oninput="sellInputs['${s}']=this.value">
      <button class="sell" onclick="sell('${s}')">Sell</button>
      <button class="sell" onclick="sellAll('${s}')">Sell All</button><br><br>

      <button class="toggle" onclick="toggleGraph('${s}')">Graph</button>
      <canvas id="g-${s}" width="800" height="140"
        style="display:${st.show?'block':'none'}"></canvas>
    </div>`;
  }).join("");

  for(const s in stocks) if(stocks[s].show) drawGraph(s);
}
</script>
</body>
</html>
