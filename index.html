<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>WESTOCKS</title>

<style>
html,body{height:100%;margin:0;font-family:Inter,Arial,sans-serif;overflow:hidden}
body{
color:white;display:flex;justify-content:center;align-items:flex-start;
background:linear-gradient(270deg,#0f172a,#022b3a,#0f172a);
background-size:600% 600%;animation:gradientAnimation 18s ease infinite}
@keyframes gradientAnimation{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}

.app{width:1100px;height:700px;display:grid;grid-template-columns:1fr 360px;gap:20px;padding:24px;box-sizing:border-box}
.main,.side{
background:rgba(255,255,255,.04);border-radius:14px;
box-shadow:0 6px 30px rgba(0,0,0,.45);overflow:auto}
.main{padding:28px}
.side{padding:16px}

h1{font-size:34px;letter-spacing:3px}
.small{font-size:13px;opacity:.85}

.market-list{display:flex;flex-direction:column;gap:12px;margin-top:12px}
.stock{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:10px;background:rgba(255,255,255,.05)}

.btn{padding:10px 16px;border-radius:10px;border:none;font-weight:700;cursor:pointer}
.btn-primary{background:white;color:#061124}
.btn-ghost{background:rgba(255,255,255,.06);color:white}

footer{font-size:12px;opacity:.7;margin-top:16px}
</style>
</head>

<body>

<div class="app">
  <div class="main">
    <h1>WESTOCKS</h1>
    <p class="small">Mini stock market demo (random prices)</p>

    <div class="portfolio">
      <h3>Portfolio</h3>
      <div id="portfolioList" class="small">Loading...</div>
      <div style="margin-top:8px;font-weight:700">Cash: <span id="cashBal">$0.00</span></div>
    </div>

    <footer>
      Demo only â€” no real money or real stock data.
    </footer>
  </div>

  <aside class="side">
    <h3>Stock Market</h3>
    <div class="small">Prices update every few seconds</div>
    <div id="marketList" class="market-list"></div>
  </aside>
</div>

<script>
/* ===== MARKET DATA ===== */
const DEFAULT_MARKET = {
  lastUpdate: Date.now(),
  stocks: {
    AAPL: { name: "Apple Inc.", price: 180.00 },
    MSFT: { name: "Microsoft", price: 330.00 },
    GOOGL:{ name: "Alphabet (Google)", price: 140.00 },
    AMZN: { name: "Amazon", price: 155.00 },
    TSLA: { name: "Tesla", price: 240.00 },
    META: { name: "Meta Platforms", price: 310.00 },
    NVDA: { name: "NVIDIA", price: 480.00 }
  }
};

let market = JSON.parse(localStorage.getItem("market")) || DEFAULT_MARKET;
let portfolio = JSON.parse(localStorage.getItem("portfolio")) || { cashUSD: 1000, holdings:{} };

/* ===== HELPERS ===== */
function fmtUSD(n){return "$"+n.toFixed(2)}

function randomWalkPrices(){
  for(const [sym,info] of Object.entries(market.stocks)){
    const volatility={
      TSLA:0.08,NVDA:0.07,META:0.06,
      AAPL:0.04,MSFT:0.035,GOOGL:0.04,AMZN:0.05
    }[sym]||0.04;

    const change=(Math.random()-0.5)*volatility;
    let newPrice=info.price*(1+change);
    newPrice=Math.max(newPrice,info.price*0.7);
    info.price=Number(newPrice.toFixed(2));
  }
  market.lastUpdate=Date.now();
  saveState();
}

/* ===== RENDER ===== */
function renderMarket(){
  const list=document.getElementById("marketList");
  list.innerHTML="";
  for(const [sym,info] of Object.entries(market.stocks)){
    const div=document.createElement("div");
    div.className="stock";
    div.innerHTML=`
      <div>
        <strong>${sym}</strong>
        <div class="small">${info.name}</div>
      </div>
      <div style="text-align:right">
        <div style="font-weight:800">${fmtUSD(info.price)}</div>
        <button class="btn btn-ghost" onclick="buy('${sym}')">Buy</button>
        <button class="btn btn-ghost" onclick="sell('${sym}')">Sell</button>
      </div>`;
    list.appendChild(div);
  }
}

function renderPortfolio(){
  const el=document.getElementById("portfolioList");
  el.innerHTML="";
  for(const [sym,qty] of Object.entries(portfolio.holdings)){
    const value=qty*market.stocks[sym].price;
    el.innerHTML+=`<div>${sym}: ${qty.toFixed(2)} (${fmtUSD(value)})</div>`;
  }
  if(!Object.keys(portfolio.holdings).length)
    el.innerHTML="<div class='small'>No holdings</div>";
  document.getElementById("cashBal").innerText=fmtUSD(portfolio.cashUSD);
}

/* ===== BUY / SELL ===== */
function buy(sym){
  const price=market.stocks[sym].price;
  const shares=100/price;
  portfolio.cashUSD-=100;
  portfolio.holdings[sym]=(portfolio.holdings[sym]||0)+shares;
  saveState();
}

function sell(sym){
  if(!portfolio.holdings[sym])return;
  const value=portfolio.holdings[sym]*market.stocks[sym].price;
  portfolio.cashUSD+=value;
  delete portfolio.holdings[sym];
  saveState();
}

/* ===== SAVE ===== */
function saveState(){
  localStorage.setItem("market",JSON.stringify(market));
  localStorage.setItem("portfolio",JSON.stringify(portfolio));
  renderMarket();
  renderPortfolio();
}

/* ===== START ===== */
renderMarket();
renderPortfolio();
setInterval(randomWalkPrices,4000);
</script>

</body>
</html>
